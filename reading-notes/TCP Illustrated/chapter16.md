# 第十六章 TCP拥塞控制

## 16.2.1 慢启动

假设没有出现丢包情况而且每个数据包都有相应的ACK，第一个数据段的ACK到达，说明可以发送一个新的数据段，每接受一个好的ACK响应，慢启动算法会以min(N, SMSS)来增加cwnd的值，这里的N是指在未经确认的传输数据中能够通过这一好的ACK确认的字节数，所谓好的ACK，是指新接收的ACK号大于之前收到的ACK。

## 16.2.2 拥塞避免

在建立之初以及由于超时判定丢包的情况下，需要执行慢启动操作，在慢启动阶段，cwnd会快速增长，帮助确立一个慢启动阈值。一旦达到这个阈值，就要进入拥塞避免阶段。每接受一个新的ACK，cwnd会做出以下更新：cwnd = cwnt + SMSS * SMSS / cwnd，在上面的式子中，如果cwnd0 = k * SMSS，那么在接受到一个新的ACK后，cwnd会增长了1/k倍。

## 16.2.5 标准TCP

当接受到三次ACK时，会执行以下行为：

1. ssthresh更新为大于等式 ssthresh = max(在外数据/2, 2 * SMSS)的值。
2. 启用快速重传算法，将cwnd设为(ssthresh + 3 * SMSS)
3. 没接受到一个好的ACK，cwnd值暂时增加1SMSS
4. 没接受到一个好的ACK，将cwnd重设为ssthresh。

第二步和第三步构成了快速恢复，以下两种情况会执行慢启动，当新连接建议以及出现重传超时的时候

## 16.3.1 NewReno

当一个窗口中出现多个数据包丢失的时候，一旦其中一个包重传成功，发送方就会接受到一个好的ACK，这样快速恢复阶段中cwnd窗口的暂时膨胀就会停止，而事实上丢失的其他数据可能并没有完成重传。Reno算法在接受到局部ACK后就停止拥塞窗口的膨胀，并将其减小到特定值，这种做法可能导致在重传计数器超时之前，传输通道一直处于空闲状态。因为快速重传需要三个重复ACK，加入网络中没有足够的数据包在传输，那么就不可能因为丢包而触发快速重传，最终导致计时器超时，引发看慢动操作，从而严重影响网络吞吐性能。  
为解决上述的问题，提出了一种改进的算法，称为NewReno。该算法对快速恢复做出了改进，它记录了重传前发送的最大序列号，仅当接收到的ACK号不小于恢复点的时候，才停止快速恢复阶段。

16.3.3 速率减半